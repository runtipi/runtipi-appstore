{
  "services": [
    {
      "name": "firefly-iii",
      "image": "fireflyiii/core:version-6.4.2",
      "isMain": true,
      "internalPort": 8080,
      "environment": [
        {
          "key": "APP_ENV",
          "value": "local"
        },
        {
          "key": "APP_DEBUG",
          "value": "false"
        },
        {
          "key": "SITE_OWNER",
          "value": "${EMAIL}"
        },
        {
          "key": "APP_KEY",
          "value": "${APP_KEY}"
        },
        {
          "key": "STATIC_CRON_TOKEN",
          "value": "${STATIC_CRON_TOKEN}"
        },
        {
          "key": "TZ",
          "value": "${TZ}"
        },
        {
          "key": "TRUSTED_PROXIES",
          "value": "**"
        },
        {
          "key": "DB_CONNECTION",
          "value": "mysql"
        },
        {
          "key": "DB_HOST",
          "value": "firefly-iii-db"
        },
        {
          "key": "DB_PORT",
          "value": "3306"
        },
        {
          "key": "DB_DATABASE",
          "value": "firefly"
        },
        {
          "key": "DB_USERNAME",
          "value": "firefly"
        },
        {
          "key": "DB_PASSWORD",
          "value": "${MYSQL_PASSWORD}"
        },
        {
          "key": "COOKIE_PATH",
          "value": "\"/\""
        },
        {
          "key": "COOKIE_SECURE",
          "value": "false"
        },
        {
          "key": "COOKIE_SAMESITE",
          "value": "lax"
        },
        {
          "key": "APP_NAME",
          "value": "FireflyIII"
        },
        {
          "key": "BROADCAST_DRIVER",
          "value": "log"
        },
        {
          "key": "QUEUE_DRIVER",
          "value": "sync"
        },
        {
          "key": "CACHE_PREFIX",
          "value": "firefly"
        },
        {
          "key": "IS_HEROKU",
          "value": "false"
        },
        {
          "key": "FIREFLY_III_LAYOUT",
          "value": "v1"
        },
        {
          "key": "APP_URL",
          "value": "http://localhost:${APP_PORT}"
        }
      ],
      "dependsOn": ["firefly-iii-db"],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/uplodad",
          "containerPath": "/var/www/html/storage/upload"
        }
      ]
    },
    {
      "name": "firefly-iii-db",
      "image": "mariadb",
      "hostname": "fireflyiii-db",
      "environment": [
        {
          "key": "MYSQL_RANDOM_ROOT_PASSWORD",
          "value": "yes"
        },
        {
          "key": "MYSQL_USER",
          "value": "firefly"
        },
        {
          "key": "MYSQL_PASSWORD",
          "value": "${MYSQL_PASSWORD}"
        },
        {
          "key": "MYSQL_DATABASE",
          "value": "firefly"
        }
      ],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/db",
          "containerPath": "/var/lib/mysql"
        }
      ]
    },
    {
      "name": "firefly-iii-cron",
      "image": "alpine",
      "command": "sh -c \"echo \\\"0 3 * * * wget -qO- http://${APP_DOMAIN}/api/v1/cron/${STATIC_CRON_TOKEN}\\\" | crontab - && crond -f -L /dev/stdout\""
    }
  ],
  "schemaVersion": 2,
  "$schema": "https://schemas.runtipi.io/v2/dynamic-compose.json"
}
