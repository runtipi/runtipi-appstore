{
  "services": [
    {
      "name": "linkstack",
      "image": "linkstackorg/linkstack:latest",
      "isMain": true,
      "internalPort": 80,
      "hostname": "linkstack",
      "environment": [
        {
          "key": "TZ",
          "value": "${TZ}"
        },
        {
          "key": "HTTP_SERVER_NAME",
          "value": "${APP_DOMAIN}"
        },
        {
          "key": "HTTPS_SERVER_NAME",
          "value": "${APP_DOMAIN}"
        },
        {
          "key": "LOG_LEVEL",
          "value": "info"
        },
        {
          "key": "PHP_MEMORY_LIMIT",
          "value": "256M"
        },
        {
          "key": "UPLOAD_MAX_FILESIZE",
          "value": "8M"
        },
        {
          "key": "DB_CONNECTION",
          "value": "sqlite"
        },
        {
          "key": "FORCE_HTTPS",
          "value": "false"
        }
      ],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/linkstack",
          "containerPath": "/data"
        }
      ],
      "entrypoint": "/bin/sh",
      "command": [
        "-c",
        "cp -n -r /htdocs/database/ /data/database\n cp -n /htdocs/.env /data/.env\n cp -n -r /htdocs/assets/images /data/images\n cp -n -r /htdocs/themes /data/themes\n cp -n -r /htdocs/assets/img /data/img\n chown -R apache:apache /data\n rm -rf /htdocs/database/\n rm /htdocs/.env\n rm -rf /htdocs/assets/images\n rm -rf /htdocs/themes\n rm -rf /htdocs/assets/img\n sed -i 's/FORCE_HTTPS=false/FORCE_HTTPS=true/g' /data/.env\n ln -s /data/database /htdocs/database\n ln -s /data/.env /htdocs/.env\n ln -s /data/images /htdocs/assets/images\n ln -s /data/themes /htdocs/themes\n ln -s /data/img/ /htdocs/assets/img\n cd /htdocs\n exec /usr/local/bin/docker-entrypoint.sh server"
      ]
    }
  ],
  "schemaVersion": 2,
  "$schema": "https://schemas.runtipi.io/v2/dynamic-compose.json"
}
