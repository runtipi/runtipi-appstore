{
  "services": [
    {
      "image": "mempool/frontend:v3.2.1",
      "name": "mempool",
      "internalPort": 8080,
      "isMain": true,
      "command": "nginx -g 'daemon off;'",
      "environment": [
        {
          "key": "FRONTEND_HTTP_PORT",
          "value": "8080"
        },
        {
          "key": "BACKEND_MAINNET_HTTP_HOST",
          "value": "mempool-api"
        }
      ],
      "dependsOn": ["mempool-db"],
      "stopGracePeriod": "1m"
    },
    {
      "image": "mempool/backend:v3.2.1",
      "name": "mempool-api",
      "volumes": [
        {
          "hostPath": "${BITCOIND_DIR:-${APP_DATA_DIR}/../bitcoind/data}",
          "containerPath": "/data/.bitcoin",
          "readOnly": true
        },
        {
          "hostPath": "${APP_DATA_DIR}/data",
          "containerPath": "/backend/cache"
        }
      ],
      "command": "./start.sh",
      "environment": [
        {
          "key": "MEMPOOL_BACKEND",
          "value": "electrum"
        },
        {
          "key": "ELECTRUM_HOST",
          "value": "${ELECTRUM_HOST:-electrs}"
        },
        {
          "key": "ELECTRUM_PORT",
          "value": "${ELECTRUM_PORT:-50001}"
        },
        {
          "key": "ELECTRUM_TLS_ENABLED",
          "value": "false"
        },
        {
          "key": "CORE_RPC_HOST",
          "value": "${CORE_RPC_HOST:-bitcoind}"
        },
        {
          "key": "CORE_RPC_PORT",
          "value": "8332"
        },
        {
          "key": "CORE_RPC_COOKIE",
          "value": "true"
        },
        {
          "key": "CORE_RPC_COOKIE_PATH",
          "value": "/data/.bitcoin/.cookie"
        },
        {
          "key": "CORE_RPC_TIMEOUT",
          "value": "60000"
        },
        {
          "key": "DATABASE_ENABLED",
          "value": "true"
        },
        {
          "key": "DATABASE_HOST",
          "value": "mempool-db"
        },
        {
          "key": "DATABASE_DATABASE",
          "value": "mempool"
        },
        {
          "key": "DATABASE_USERNAME",
          "value": "mempool"
        },
        {
          "key": "DATABASE_PASSWORD",
          "value": "${MEMPOOL_DB_PASSWORD}"
        },
        {
          "key": "STATISTICS_ENABLED",
          "value": "true"
        }
      ],
      "dependsOn": ["mempool-db"],
      "stopGracePeriod": "1m",
      "user": "0:0"
    },
    {
      "image": "mariadb:10.5.21",
      "name": "mempool-db",
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/db",
          "containerPath": "/var/lib/mysql"
        }
      ],
      "environment": [
        {
          "key": "MYSQL_DATABASE",
          "value": "mempool"
        },
        {
          "key": "MYSQL_USER",
          "value": "mempool"
        },
        {
          "key": "MYSQL_PASSWORD",
          "value": "${MEMPOOL_DB_PASSWORD}"
        },
        {
          "key": "MYSQL_ROOT_PASSWORD",
          "value": "${MEMPOOL_DB_PASSWORD}"
        }
      ],
      "stopGracePeriod": "1m"
    }
  ],
  "schemaVersion": 2,
  "$schema": "https://schemas.runtipi.io/v2/dynamic-compose.json"
}
